<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Will You Be My Valentine?</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg1:#f9c5d1;
    --bg2:#fbc2eb;
    --card:#ffffff;
    --text:#333;
    --muted:#8a8a8a;
    --primary:#ff4d6d;
    --soft:#f0f0f0;
  }

  *{ box-sizing:border-box; font-family:"Poppins", sans-serif; }

  body{
    margin:0;
    min-height:100vh;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
  }

  /*Fake loading overlay*/
  #loader{
    position:fixed;
    inset:0;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:999999;
    padding:18px;
  }

  .load-card{
    width:min(360px, 92vw);
    background:rgba(255,255,255,0.92);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-radius:18px;
    padding:22px 18px;
    box-shadow:0 12px 40px rgba(0,0,0,0.18);
    text-align:center;
    border:1px solid rgba(255,255,255,0.55);
  }

  .spinner{
    width:42px;
    height:42px;
    border-radius:50%;
    border:5px solid #f0f0f0;
    border-top-color:var(--primary);
    margin:0 auto 14px;
    animation:spin 0.9s linear infinite;
  }
  @keyframes spin{ to{ transform:rotate(360deg); } }

  .load-title{
    font-weight:700;
    color:var(--text);
    letter-spacing:0.2px;
  }
  .load-sub{
    font-size:12px;
    color:#777;
    margin-top:6px;
  }

  .progress-wrap{
    width:100%;
    height:10px;
    background:#f0f0f0;
    border-radius:999px;
    overflow:hidden;
    margin-top:14px;
  }
  .progress-bar{
    width:0%;
    height:100%;
    background:var(--primary);
    border-radius:999px;
    transition:width 0.2s ease;
  }
   .reveal-after-scratch{
  font-size: 18px;  
  }

  /*Floating hearts*/
  .heart{
    position:fixed;
    bottom:-30px;
    pointer-events:none;
    opacity:0.0;
    animation:floatUp linear forwards;
    z-index:3;
    filter: drop-shadow(0 6px 10px rgba(0,0,0,0.08));
  }

  @keyframes floatUp{
    0%{
      transform:translateY(0) translateX(0) scale(var(--scale));
      opacity:0;
    }
    12%{ opacity: var(--alpha); }
    100%{
      transform:translateY(-112vh) translateX(var(--drift)) scale(calc(var(--scale) * 1.03));
      opacity:0;
    }
  }

  /*Main card*/
  .card{
    width:min(420px, 92vw);
    background:rgba(255,255,255,0.92);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-radius:22px;
    padding:26px 18px;
    text-align:center;
    box-shadow:0 12px 40px rgba(0,0,0,0.16);
    border:1px solid rgba(255,255,255,0.55);
    position:relative;
    overflow:hidden;
    z-index:10;
    display:none;
  }

  .top-badge{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding:6px 10px;
    border-radius:999px;
    background:rgba(255,77,109,0.10);
    color:#c93b55;
    font-weight:600;
    font-size:12px;
    margin-bottom:6px;
  }

  .emoji{
    font-size:56px;
    line-height:1;
    margin:6px 0 8px;
  }

  h2{
    margin:10px 0 14px;
    font-weight:700;
    color:var(--text);
    letter-spacing:0.2px;
  }

  .subtext{
    margin:0 0 18px;
    font-size:13px;
    color:var(--muted);
  }

  .buttons{
    position:relative;
    height:96px;
    margin:0 auto;
    width:min(320px, 86vw);
  }

  button{
    border:none;
    padding:13px 28px;
    font-size:15px;
    border-radius:999px;
    cursor:pointer;
    position:absolute;
    transition:transform 0.18s ease, background 0.18s ease;
    user-select:none;
    -webkit-user-select:none;
    touch-action:none;
    font-weight:600;
    will-change: transform, left, top;
  }

  #yesBtn{
    background:var(--primary);
    color:white;
    left:0;
    top:18px;
    box-shadow:0 12px 24px rgba(255,77,109,0.35);
    transform:scale(1);
  }
  #yesBtn:hover{ transform:scale(1.12); }
  #yesBtn:active{ transform:scale(1.05); }

  #noBtn{
    background:#efefef;
    color:#444;
    right:0;
    top:18px;
    z-index:9999;
    border:1px solid rgba(0,0,0,0.06);
  }

  .hint{
    margin-top:14px;
    font-size:12px;
    color:#8c8c8c;
  }

  /*Screen switching*/
  .screen{ display:none; }
  .screen.active{ display:block; }

  /*audio button only on main*/
  #question{ position:relative; }

  .audio-toggle{
    position:absolute;
    top:6px;
    right:6px;
    width:28px;
    height:28px;
    border-radius:50%;
    border:1px solid rgba(0,0,0,0.10);
    background:rgba(255,255,255,0.9);
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    user-select:none;
    -webkit-user-select:none;
    box-shadow:0 6px 14px rgba(0,0,0,0.10);
    transition:transform 0.15s ease;
    z-index:60;
    padding:0;
  }
  .audio-toggle:hover{ transform:scale(1.06); }
  .audio-toggle:active{ transform:scale(0.95); }
  .audio-toggle span{ font-size:14px; line-height:1; }

  /*YES SCREEN*/

  .scratch-wrap{
    width: min(220px, 70vw);
    margin: 0 auto 6px;
    border-radius:14px;
    overflow:hidden;
    position:relative;
  }

  .scratch-wrap img{
    width:100%;
    height:auto;
    display:block;
  }

  /*Hide reveal image until scratch layer is ready*/
  #revealImg.hidden{ opacity:0; }
  #revealImg{
    opacity:1;
    transition: opacity 0.15s ease;
  }

  #scratchCanvas{
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    display:block;
    touch-action:none;
    cursor:grab;
  }
  #scratchCanvas:active{ cursor:grabbing; }

  .scratch-hint{
    margin: 0 0 6px;
    font-size:12px;
    color:#d30128;
    font-weight:600;
  }

  #yay{
    padding-top: 4px;
    padding-bottom: 6px;
  }

  #yay h2,
  #yay h1{
    font-family:"Poppins", sans-serif;
    color: var(--primary);
  }

  #yay h2{
    margin:8px 0 10px;
    font-weight:700;
    letter-spacing:0.2px;
  }

  #yay h1{
    font-size:30px;
    margin:10px 0 8px;
    font-weight:700;
  }

  .love-line{ margin: 6px 0 0; }

  .gif-box{
    margin-top:10px;
    width:100%;
    height:200px;
    border-radius:14px;
    background:transparent;
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
  }

  .gif-box img{
    width:100%;
    height:100%;
    object-fit:cover;
    display:block;
  }

  .actions{
    margin-top:14px;
    display:flex;
    gap:10px;
    justify-content:center;
    flex-wrap:wrap;
  }

  .secondary{
    position:relative;
    background:rgba(0,0,0,0.06);
    color:#333;
    box-shadow:none;
  }
  .secondary:active{ transform:scale(0.98); }

  /*Confetti*/
  .confetti{
    position:fixed;
    top:-10px;
    width:10px;
    height:14px;
    border-radius:3px;
    opacity:0.95;
    pointer-events:none;
    animation:confettiFall linear forwards;
    z-index:20;
  }
  @keyframes confettiFall{
    to{
      transform: translateY(110vh) rotate(720deg);
      opacity:0.98;
    }
  }

  /*hidden until scratch reaches 60%*/
  .reveal-after-scratch{
    opacity:0;
    transform:translateY(12px);
    transition:opacity .6s ease, transform .6s ease;
    pointer-events:none;
  }
  .reveal-after-scratch.show{
    opacity:1;
    transform:translateY(0);
    pointer-events:auto;
  }
    .love-line{
  font-size: 36px;
}
  @media (max-width: 420px){
    .emoji{ font-size:50px; }
    h2{ font-size:18px; }
    .buttons{ height:104px; }
    button{ font-size:14px; padding:12px 24px; }

    #yay h1{ font-size:26px; }

    .scratch-wrap{
      width: min(200px, 78vw);
      margin-bottom:6px;
    }

    .gif-box{ height:180px; margin-top:8px; }
  }
</style>
</head>

<body>

<div id="loader">
  <div class="load-card">
    <div class="spinner"></div>
    <div class="load-title" id="loadTitle">Opening link‚Ä¶</div>
    <div class="load-sub" id="loadSub">Please wait</div>
    <div class="progress-wrap">
      <div class="progress-bar" id="progressBar"></div>
    </div>
  </div>
</div>

<div class="card" id="mainCard">
  <div class="top-badge">üíå message for the most beautiful person in my life</div>

  <div id="question" class="screen active">
    <button class="audio-toggle" id="audioToggle" type="button" aria-label="Toggle audio">
      <span id="audioIcon">üîä</span>
    </button>

    <div class="emoji">üê±üíó</div>
    <h2>nhoella, will you be my valentine?</h2>
    <p class="subtext">clicking no might not be the right answer</p>

    <div class="buttons" id="buttonsArea">
      <button id="yesBtn">Yes</button>
      <button id="noBtn">No</button>
    </div>

    <div class="hint">hint: click Yes</div>
  </div>

  <!--YES PAGE-->
  <div id="yay" class="screen">
    <div class="scratch-hint">*scratch the box for a chance to win*</div>

    <div class="scratch-wrap" id="scratchWrap">
      <img class="top-img hidden" id="revealImg" src="623153072_904265805805774_8905556891462974809_n.jpg" alt=" ">
      <canvas id="scratchCanvas"></canvas>
    </div>

    <!--hidden until scratch reaches 60%-->
    <h2 class="reveal-after-scratch">congrats! you won a date with me</h2>
    <h1 class="date-text reveal-after-scratch">see you on February 14!</h1>
    <h1 class="love-line reveal-after-scratch">I LOVE YOU!</h1>

    <div class="gif-box reveal-after-scratch" id="gifReveal">
      <img src="giphy (2).gif" alt="celebration gif">
    </div>

    <div class="actions">
      <button class="secondary" id="replayBtn" type="button">Replay</button>
      <button class="secondary" id="stopHeartsBtn" type="button">Stop hearts</button>
    </div>
  </div>
</div>

<script>
  const loader = document.getElementById("loader");
  const mainCard = document.getElementById("mainCard");
  const progressBar = document.getElementById("progressBar");
  const loadTitle = document.getElementById("loadTitle");
  const loadSub = document.getElementById("loadSub");

  const loadTitles = ["Verifying‚Ä¶", "Opening love message‚Ä¶", "Loading sweet words‚Ä¶"];
  const loadSubs = ["Please wait", "Almost there", "Just a moment", "Securing our connection"];

  loadTitle.textContent = loadTitles[Math.floor(Math.random() * loadTitles.length)];
  loadSub.textContent = loadSubs[Math.floor(Math.random() * loadSubs.length)];

  (function fakeLoad(){
    let p = 0;
    const totalTime = 1200 + Math.random() * 1000;
    const step = 60;
    const incBase = 100 / (totalTime / step);

    const timer = setInterval(() => {
      p = Math.min(100, p + incBase + Math.random() * 3);
      progressBar.style.width = p + "%";

      if (p >= 100) {
        clearInterval(timer);
        loader.style.display = "none";
        mainCard.style.display = "block";
      }
    }, step);
  })();

  /*Hearts*/
  const heartChars = ["üíñ","üíó","üíï","üíû","üíì","üíù","‚ù§Ô∏è"];
  let heartsInterval = null;
  let heartsEnabled = true;

  function spawnHeart(){
    if (!heartsEnabled) return;

    const h = document.createElement("div");
    h.className = "heart";
    h.textContent = heartChars[Math.floor(Math.random() * heartChars.length)];

    const left = Math.random() * 100;
    const dur  = 6 + Math.random() * 4;
    const drift = (Math.random() * 120 - 60) + "px";
    const scale = (0.7 + Math.random() * 1.0).toFixed(2);
    const alpha = (0.35 + Math.random() * 0.35).toFixed(2);

    h.style.left = left + "vw";
    h.style.animationDuration = dur + "s";
    h.style.setProperty("--drift", drift);
    h.style.setProperty("--scale", scale);
    h.style.setProperty("--alpha", alpha);
    h.style.fontSize = (14 + Math.random() * 12) + "px";

    document.body.appendChild(h);
    setTimeout(() => h.remove(), dur * 1000 + 300);
  }

  function startHearts(){
    if (heartsInterval) return;
    heartsInterval = setInterval(spawnHeart, 520);
  }

  function stopHearts(){
    heartsEnabled = false;
    if (heartsInterval){
      clearInterval(heartsInterval);
      heartsInterval = null;
    }
  }

  setTimeout(startHearts, 1600);

  /*Sounds*/
  const AudioCtx = window.AudioContext || window.webkitAudioContext;
  const audioCtx = AudioCtx ? new AudioCtx() : null;

  let audioEnabled = true;
  const audioToggle = document.getElementById("audioToggle");
  const audioIcon = document.getElementById("audioIcon");

  audioToggle.addEventListener("click", () => {
    audioEnabled = !audioEnabled;
    audioIcon.textContent = audioEnabled ? "üîä" : "üîá";
    if (audioCtx){
      if (!audioEnabled) audioCtx.suspend();
      else audioCtx.resume();
    }
  });

  function playTone(freq, durationMs, type="sine", gainValue=0.05){
    if (!audioEnabled) return;
    if (!audioCtx) return;
    if (audioCtx.state === "suspended") audioCtx.resume();

    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();

    osc.type = type;
    osc.frequency.value = freq;

    gain.gain.value = 0;
    gain.gain.linearRampToValueAtTime(gainValue, audioCtx.currentTime + 0.01);
    gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + durationMs/1000);

    osc.connect(gain);
    gain.connect(audioCtx.destination);

    osc.start();
    osc.stop(audioCtx.currentTime + durationMs/1000);
  }

  function playYesSound(){
    playTone(523, 140, "sine", 0.06);
    setTimeout(() => playTone(659, 160, "sine", 0.06), 120);
    setTimeout(() => playTone(784, 180, "sine", 0.06), 260);
  }

  function playNoSound(){
    playTone(330, 90, "triangle", 0.05);
  }

  function playRevealSound(){
    playTone(880, 120, "sine", 0.08);
    setTimeout(() => playTone(1046, 160, "sine", 0.08), 120);
    setTimeout(() => playTone(1318, 220, "sine", 0.08), 260);
  }

  /*Screens + buttons*/
  const question = document.getElementById("question");
  const yay = document.getElementById("yay");
  const buttonsArea = document.getElementById("buttonsArea");
  const noBtn = document.getElementById("noBtn");
  const yesBtn = document.getElementById("yesBtn");

  let pointerX = 0, pointerY = 0;

  document.addEventListener("mousemove", (e) => {
    pointerX = e.clientX;
    pointerY = e.clientY;
  });

  document.addEventListener("touchmove", (e) => {
    const t = e.touches[0];
    pointerX = t.clientX;
    pointerY = t.clientY;
  }, { passive:false });

  function rectsOverlap(a, b){
    return !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom);
  }

  function moveNoButtonSmartAvoidCursor(){
    playNoSound();

    const areaRect = buttonsArea.getBoundingClientRect();
    const noRect = noBtn.getBoundingClientRect();
    const yesRect = yesBtn.getBoundingClientRect();

    const padding = 8;
    const maxX = Math.max(0, areaRect.width - noRect.width - padding);
    const maxY = Math.max(0, areaRect.height - noRect.height - padding);

    const avoidPad = 18;
    const yesAvoid = {
      left: (yesRect.left - areaRect.left) - avoidPad,
      top: (yesRect.top - areaRect.top) - avoidPad,
      right: (yesRect.right - areaRect.left) + avoidPad,
      bottom: (yesRect.bottom - areaRect.top) + avoidPad
    };

    const cursorInAreaX = pointerX - areaRect.left;
    const cursorInAreaY = pointerY - areaRect.top;
    const cursorRadius = 80;

    for (let i = 0; i < 80; i++){
      const x = Math.random() * maxX;
      const y = Math.random() * maxY;

      const candidate = {
        left: x,
        top: y,
        right: x + noRect.width,
        bottom: y + noRect.height
      };

      if (rectsOverlap(candidate, yesAvoid)) continue;

      const centerX = x + noRect.width / 2;
      const centerY = y + noRect.height / 2;
      const dist = Math.hypot(centerX - cursorInAreaX, centerY - cursorInAreaY);
      if (dist < cursorRadius) continue;

      noBtn.style.left = x + "px";
      noBtn.style.top  = y + "px";
      noBtn.style.right = "auto";
      return;
    }

    const x = Math.random() * maxX;
    const y = Math.random() * maxY;
    noBtn.style.left = x + "px";
    noBtn.style.top  = y + "px";
    noBtn.style.right = "auto";
  }

  noBtn.addEventListener("mouseenter", moveNoButtonSmartAvoidCursor);
  noBtn.addEventListener("mouseover", moveNoButtonSmartAvoidCursor);

  noBtn.addEventListener("touchstart", (e) => {
    e.preventDefault();
    const t = e.touches[0];
    pointerX = t.clientX;
    pointerY = t.clientY;
    moveNoButtonSmartAvoidCursor();
  }, { passive:false });

  function spawnConfettiBurst(){
    const pieces = 80;
    for (let i = 0; i < pieces; i++){
      const c = document.createElement("div");
      c.className = "confetti";
      c.style.left = (Math.random() * 100) + "vw";

      const w = 6 + Math.random() * 8;
      const h = 10 + Math.random() * 12;
      c.style.width = w + "px";
      c.style.height = h + "px";

      const hue = Math.floor(Math.random() * 360);
      c.style.background = `hsl(${hue} 85% 60%)`;

      const dur = 2.6 + Math.random() * 1.8;
      c.style.animationDuration = dur + "s";
      c.style.animationDelay = (Math.random() * 0.2) + "s";

      document.body.appendChild(c);
      setTimeout(() => c.remove(), (dur + 0.3) * 1000);
    }
  }

  function showScreen(hideEl, showEl){
    hideEl.classList.remove("active");
    showEl.classList.add("active");
  }

  /*SCRATCH SETUP 60% reveal*/
  const scratchWrap = document.getElementById("scratchWrap");
  const scratchCanvas = document.getElementById("scratchCanvas");
  const revealImg = document.getElementById("revealImg");
  const sctx = scratchCanvas.getContext("2d");

  let isScratching = false;
  let revealed = false;

  let rafPending = false;

  function paintGlitterLayer(w, h){
    const g = sctx.createLinearGradient(0, 0, w, h);
    g.addColorStop(0, "#e7e7e7");
    g.addColorStop(1, "#cfcfcf");
    sctx.fillStyle = g;
    sctx.fillRect(0, 0, w, h);

    const dots = Math.floor((w * h) / 220);
    for (let i = 0; i < dots; i++){
      const x = Math.random() * w;
      const y = Math.random() * h;
      const r = 0.5 + Math.random() * 1.3;

      const a = 0.08 + Math.random() * 0.18;
      sctx.fillStyle = `rgba(255,255,255,${a})`;
      sctx.beginPath();
      sctx.arc(x, y, r, 0, Math.PI * 2);
      sctx.fill();

      if (Math.random() < 0.10){
        sctx.fillStyle = `rgba(255,77,109,${0.06 + Math.random() * 0.10})`;
        sctx.beginPath();
        sctx.arc(x + (Math.random()*2-1), y + (Math.random()*2-1), r, 0, Math.PI * 2);
        sctx.fill();
      }
    }

    sctx.globalAlpha = 0.10;
    sctx.strokeStyle = "#ffffff";
    for (let i = 0; i < 14; i++){
      sctx.lineWidth = 1 + Math.random() * 2;
      sctx.beginPath();
      sctx.moveTo(Math.random() * w, Math.random() * h);
      sctx.lineTo(Math.random() * w, Math.random() * h);
      sctx.stroke();
    }
    sctx.globalAlpha = 1;
  }

  function resizeScratch(){
    //hide image first
    revealImg.classList.add("hidden");

    const rect = scratchWrap.getBoundingClientRect();
    const dpr = window.devicePixelRatio || 1;

    scratchCanvas.width = Math.floor(rect.width * dpr);
    scratchCanvas.height = Math.floor(rect.height * dpr);

    sctx.setTransform(dpr, 0, 0, dpr, 0, 0);

    sctx.globalCompositeOperation = "source-over";
    paintGlitterLayer(rect.width, rect.height);

    sctx.fillStyle = "rgba(0,0,0,0.18)";
    sctx.font = "700 14px Poppins, sans-serif";
    sctx.textAlign = "center";
    sctx.textBaseline = "middle";
    sctx.fillText("SCRATCH HERE", rect.width / 2, rect.height / 2);

    sctx.globalCompositeOperation = "destination-out";

    //show image only after scratch layer is ready
    requestAnimationFrame(() => {
      revealImg.classList.remove("hidden");
    });
  }

  function getPos(e){
    const rect = scratchCanvas.getBoundingClientRect();
    const clientX = (e.touches ? e.touches[0].clientX : e.clientX);
    const clientY = (e.touches ? e.touches[0].clientY : e.clientY);
    return { x: clientX - rect.left, y: clientY - rect.top };
  }

  function scratchAt(x, y){
    const radius = 24;
    sctx.beginPath();
    sctx.arc(x, y, radius, 0, Math.PI * 2);
    sctx.fill();

    if (!revealed) schedulePercentCheck();
  }

  function handleDown(e){
    e.preventDefault();
    isScratching = true;
    const p = getPos(e);
    scratchAt(p.x, p.y);
  }

  function handleMove(e){
    if (!isScratching) return;
    e.preventDefault();
    const p = getPos(e);
    scratchAt(p.x, p.y);
  }

  function handleUp(){
    isScratching = false;
  }

  scratchCanvas.addEventListener("mousedown", handleDown);
  window.addEventListener("mousemove", handleMove);
  window.addEventListener("mouseup", handleUp);

  scratchCanvas.addEventListener("touchstart", handleDown, { passive:false });
  scratchCanvas.addEventListener("touchmove", handleMove, { passive:false });
  scratchCanvas.addEventListener("touchend", handleUp);

  function schedulePercentCheck(){
    if (rafPending) return;
    rafPending = true;
    requestAnimationFrame(() => {
      rafPending = false;
      const p = getScratchPercent();
      if (p >= 0.60) triggerReveal();  // reveal at ~60%
    });
  }

  function getScratchPercent(){
    const w = scratchCanvas.width;
    const h = scratchCanvas.height;

    const step = 8;
    const img = sctx.getImageData(0, 0, w, h).data;

    let cleared = 0;
    let total = 0;

    for (let y = 0; y < h; y += step){
      for (let x = 0; x < w; x += step){
        const idx = ((y * w) + x) * 4 + 3;
        const a = img[idx];
        if (a < 128) cleared++;
        total++;
      }
    }
    return total ? (cleared / total) : 0;
  }

  function triggerReveal(){
    if (revealed) return;
    revealed = true;

    document.querySelectorAll(".reveal-after-scratch")
      .forEach(el => el.classList.add("show"));

    scratchCanvas.style.pointerEvents = "none";

    sparkleBurstFromScratchBox();
    playRevealSound();
  }

  function sparkleBurstFromScratchBox(){
    const rect = scratchWrap.getBoundingClientRect();
    const originX = rect.left + rect.width / 2;
    const originY = rect.top + rect.height / 2;

    const hearts = ["üíñ","üíó","‚ú®","üíû","üíï"];
    const count = 34;

    for (let i = 0; i < count; i++){
      const s = document.createElement("div");
      s.textContent = hearts[Math.floor(Math.random() * hearts.length)];

      s.style.position = "fixed";
      s.style.left = originX + "px";
      s.style.top  = originY + "px";
      s.style.transform = "translate(-50%,-50%) scale(1)";
      s.style.fontSize = (14 + Math.random() * 16) + "px";
      s.style.pointerEvents = "none";
      s.style.zIndex = 30;
      s.style.opacity = "1";
      s.style.transition = "transform 1.3s ease, opacity 1.3s ease";
      s.style.filter = "drop-shadow(0 10px 18px rgba(0,0,0,0.15))";

      document.body.appendChild(s);

      const dx = (Math.random() * 260 - 130);
      const dy = (-220 - Math.random() * 220);
      const rot = (Math.random() * 180 - 90);

      requestAnimationFrame(() => {
        s.style.transform =
          `translate(calc(-50% + ${dx}px), calc(-50% + ${dy}px)) rotate(${rot}deg) scale(1.5)`;
        s.style.opacity = "0";
      });

      setTimeout(() => s.remove(), 1300);
    }
  }

  revealImg.addEventListener("load", () => resizeScratch());
  window.addEventListener("resize", () => {
    if (yay.classList.contains("active")) resizeScratch();
  });

  /*END SCRATCH*/

  yesBtn.addEventListener("click", () => {
    playYesSound();
    spawnConfettiBurst();

    //hide image before showing YES screen
    revealImg.classList.add("hidden");

    showScreen(question, yay);

    document.querySelectorAll(".reveal-after-scratch")
      .forEach(el => el.classList.remove("show"));

    revealed = false;
    scratchCanvas.style.pointerEvents = "auto";

    //draw scratch layer ASAP
    requestAnimationFrame(() => resizeScratch());
  });

  document.getElementById("replayBtn").addEventListener("click", () => {
    yay.classList.remove("active");
    question.classList.add("active");

    heartsEnabled = true;
    startHearts();

    noBtn.style.left = "auto";
    noBtn.style.right = "0";
    noBtn.style.top = "18px";
  });

  document.getElementById("stopHeartsBtn").addEventListener("click", () => {
    stopHearts();
  });
</script>

</body>
</html>
